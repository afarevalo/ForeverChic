# Encuentra la fecha mínima y máxima de la columna "Fecha de Pago"
min_fecha <- min(Data$`Fecha de Pago`)
max_fecha <- max(Data$`Fecha de Pago`)
# Extrae el mes y el día de la fecha mínima y máxima
MES1 <- format(min_fecha, "%m")  # Mes de la fecha mínima
MIN <- format(min_fecha, "%d")   # Día de la fecha mínima
MES2 <- format(max_fecha, "%m")  # Mes de la fecha máxima
MAX <- format(max_fecha, "%d")   # Día de la fecha máxima
# Vector con las abreviaturas de los meses
abreviaturas_meses <- c("ENE", "FEB", "MAR", "ABR", "MAY", "JUN",
"JUL", "AGO", "SEP", "OCT", "NOV", "DIC")
# Convierte MES1 y MES2 de números a abreviaturas
MES1 <- abreviaturas_meses[as.numeric(MES1)]
MES2 <- abreviaturas_meses[as.numeric(MES2)]
# Crea la cadena de texto
cadena_reporte <- paste0(". reporte de ventas ", MES1, " ",  MIN, " al ", MES2, " ", MAX)
cadena_reporte
#===============================================================================
# El directorio donde estan los archivos de Ventas
directorio <- "1. Ventas Mensuales"
# Chequeo de los archivos del directorio
list.files(directorio)
# Obtén la lista de archivos en el directorio actual o especificado
archivos <- list.files(directorio)
# Extrae el nombre del último archivo en la lista
ultimo_archivo <- tail(archivos, n = 1)
# Muestra el nombre del último archivo
print(ultimo_archivo)
# Extrae el número al inicio de la cadena antes del primer "."
numero_extraido <- as.numeric(sub("^([0-9]+)\\..*", "\\1", ultimo_archivo))
# Muestra el número extraído
print(numero_extraido)
numero_extraido <- numero_extraido + 1
numero_extraido
cadena_reporte <- paste(numero_extraido,". reporte_de_ventas", MES1, "/", MIN, "al", MES2, "/", MAX)
resultado_final <- paste0(numero_extraido, cadena_reporte)
resultado_final
resultado_final <- paste0(numero_extraido, cadena_reporte)
resultado_final
#===============================================================================
source("0. Nomina/APP/1. Base Ventas.R")
# Encuentra la fecha mínima y máxima de la columna "Fecha de Pago"
min_fecha <- min(Data$`Fecha de Pago`)
max_fecha <- max(Data$`Fecha de Pago`)
# Extrae el mes y el día de la fecha mínima y máxima
MES1 <- format(min_fecha, "%m")  # Mes de la fecha mínima
MIN <- format(min_fecha, "%d")   # Día de la fecha mínima
MES2 <- format(max_fecha, "%m")  # Mes de la fecha máxima
MAX <- format(max_fecha, "%d")   # Día de la fecha máxima
# Vector con las abreviaturas de los meses
abreviaturas_meses <- c("ENE", "FEB", "MAR", "ABR", "MAY", "JUN",
"JUL", "AGO", "SEP", "OCT", "NOV", "DIC")
# Convierte MES1 y MES2 de números a abreviaturas
MES1 <- abreviaturas_meses[as.numeric(MES1)]
MES2 <- abreviaturas_meses[as.numeric(MES2)]
# Crea la cadena de texto
cadena_reporte <- paste0(". reporte de ventas ", MES1, " ",  MIN, " al ", MES2, " ", MAX)
cadena_reporte
# El directorio donde estan los archivos de Ventas
directorio <- "1. Ventas Mensuales"
# Chequeo de los archivos del directorio
list.files(directorio)
# Obtén la lista de archivos en el directorio actual o especificado
archivos <- list.files(directorio)
# Extrae el nombre del último archivo en la lista
ultimo_archivo <- tail(archivos, n = 1)
# Muestra el nombre del último archivo
print(ultimo_archivo)
# Extrae el número al inicio de la cadena antes del primer "."
numero_extraido <- as.numeric(sub("^([0-9]+)\\..*", "\\1", ultimo_archivo))
# Muestra el número extraído
print(numero_extraido)
numero_extraido <- numero_extraido + 1
numero_extraido
resultado_final <- paste0(numero_extraido, cadena_reporte)
resultado_final
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
write_xlsx(Data, file.path("1. Ventas Mensuales", nuevo_nombre))
write_xlsx(Data, file.path("1. Ventas Mensuales", nuevo_nombre,".xlsx"))
nuevo_nombre <- paste0(numero_extraido, cadena_reporte,".xlsx")
nuevo_nombre
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
write_xlsx(Data, file.path("1. Ventas Mensuales", nuevo_nombre))
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
write_xlsx(Data, file.path("1. Ventas Mensuales", nuevo_nombre))
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
write_xlsx(Data, file.path("1. Ventas Mensuales", nuevo_nombre))
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
write_xlsx(Data, file.path("1. Ventas Mensuales", nuevo_nombre))
# Librerias del Proyecto
library(readxl)
library(dplyr)
library(writexl)
library(rio)
library(openxlsx)
library(stringr)
library(lubridate)
# Input del Usuario
ruta_archivo <- "C:/Users/windows/Downloads/reporte_de_ventas_14722_2024-12-12T17_39_07+00_00.xlsx"
# Leer el archivo
Data <- read_excel(ruta_archivo, sheet = "Produccion v2")
# Soluciona el problema de las filas iniciales
colnames(Data) <- Data[1, ]
Data <- Data[-c(1:1),]
rownames(Data) <- NULL
# Limpiar datos
Data <- Data %>% select("Identificador","Fecha de Pago","Nombre cliente",
"Servicio/Producto","Prestador/Vendedor","Precio de Lista",
"Precio","Descuento","Efectivo","Tarjeta de Crédito",
"Tarjeta de Débito","Cheque","Otro","Gift card",
"Transferencia Bancaria","Nequi Carlos","Daviplata Carlos",
"Nequi Nambad","Daviplata Nambad","Bold")
# Eliminar espacios múltiples
Data$`Nombre cliente` <- gsub("\\s+", " ", Data$`Nombre cliente`)
Data$`Prestador/Vendedor` <- gsub("\\s+", " ", Data$`Prestador/Vendedor`)
# Eliminar espacios al inicio y al final, si los hubiera
Data$`Nombre cliente` <- trimws(Data$`Nombre cliente`)
Data$`Prestador/Vendedor` <- trimws(Data$`Prestador/Vendedor`)
# Condicional para corregir el error de AgendaPro con la gif card
Data$`gif card` <- ifelse(Data$`gif card` == 0, 1,Data$`gif card`)
#===============================================================================
# Condicional para corregir el error de AgendaPro con la gif card
Data$`Gift card` <- ifelse(Data$`Gift card` == 0, 1,Data$`Gift card`)
View(Data)
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
write_xlsx(Data, file.path("1. Ventas Mensuales", nuevo_nombre))
file.remove(ruta_archivo)
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
nuevo_nombre
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
# Exporta la  Base de Datos
write_xlsx(Data, file.path("1. Ventas Mensuales", nuevo_nombre))
# Elimina la Base de Datos Original
file.remove(ruta_archivo)
nuevo_nombre
# Genera el nombre de la Base de Datos para Descuentos
cadena_descuentos <- paste0(". descuentos ", MES1, " ",  MIN, " al ", MES2, " ", MAX)
nuevo_descuento <- paste0(numero_extraido, cadena_descuentos,".xlsx")
nuevo_descuento
# Ruta de la Base de Datos de Descuentos
ruta_descuento <- "2. Descuentos/0. Formato"
# Ruta de la Base de Datos de Descuentos
archivo_descuento <- "2. Descuentos/0. Formato.xlsx"
ruta_descuento <- "2. Descuentos"
# Copiar el archivo a la nueva ubicación con el nuevo nombre
archivo_destino <- file.path(ruta_destino, nuevo_descuento)
nuevo_descuento <- paste0(numero_extraido, cadena_descuentos,".xlsx")
# Ruta de la Base de Datos de Descuentos
archivo_descuento <- "2. Descuentos/0. Formato.xlsx"
ruta_descuento <- "2. Descuentos"
# Copiar el archivo a la nueva ubicación con el nuevo nombre
archivo_destino <- file.path(ruta_descuento, nuevo_descuento)
file.copy(from = ruta_descuento, to = archivo_descuento, overwrite = TRUE)
file.copy(from = ruta_descuento, to = archivo_descuento, overwrite = TRUE)
# Ruta completa del archivo destino
archivo_destino <- file.path(ruta_descuento, nuevo_descuento)
# Copiar el archivo a la nueva ubicación con el nuevo nombre
file.copy(from = archivo_descuento, to = archivo_destino, overwrite = TRUE)
archivo_destino
data2 <- archivo_destino
Data <- read_excel("1. Ventas Mensuales",nuevo_nombre)
Data <- read_excel(file.path("1. Ventas Mensuales", nuevo_nombre))
#===============================================================================
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
# Corta fuego, no necesario
Data <- read_excel("1. Ventas Mensuales/1. Ventas Mensuales/3. reporte de ventas NOV 16 al NOV 30.xlsx")
# Corta fuego, no necesario
Data <- read_excel("1. Ventas Mensuales/1. Ventas Mensuales/3. reporte de ventas NOV 16 al NOV 30.xlsx")
# Corta fuego, no necesario
Data <- read_excel("1. Ventas Mensuales/1. Ventas Mensuales/3. reporte de ventas NOV 16 al NOV 30.xlsx")
# Corta fuego, no necesario
Data <- read_excel("1. Ventas Mensuales/3. reporte de ventas NOV 16 al NOV 30.xlsx")
#===============================================================================
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
#===============================================================================
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
#===============================================================================
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
#===============================================================================
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
Data <- read_excel("1. Ventas Mensuales/3. reporte de ventas NOV 16 al NOV 30.xlsx")
# Lista de servicios por Tipo
Base_Tocador <- read_excel("Info.xlsx", sheet = "1. Tocador")
# Lista de servicios por Tipo
Base_Tocador <- read_excel("0. Nomina/Info.xlsx", sheet = "1. Tocador")
# Lista de servicios por Tipo
Base_Tocador <- read_excel("0. Nomina/Info.xlsx", sheet = "1. Tocador")
Base_Spa <- read_excel("0. Nomina/Info.xlsx", sheet = "2. Spa")
Base_Depilacion <- read_excel("0. Nomina/Info.xlsx", sheet = "3. Depilacion")
Base_Bac <- read_excel("0. Nomina/Info.xlsx", sheet = "4. Bac")
Base_Colorimetria <- read_excel("0. Nomina/Info.xlsx", sheet = "5. Colorimetria")
Base_Venta <- read_excel("0. Nomina/Info.xlsx", sheet = "6. Venta")
Base_Maquillaje <- read_excel("0. Nomina/Info.xlsx", sheet = "7. Maquillaje")
Base_Maquillaje_Salon <- read_excel("0. Nomina/Info.xlsx", sheet = "8. Maquillaje Salon")
Base_Accesorios <- read_excel("0. Nomina/Info.xlsx", sheet = "9. Accesorios")
# Lista de Profesionales
Base_Profesionales <- read_excel("0. Nomina/Info.xlsx", sheet = "0. Profesionales")
# Inicalización de la Variable Tipo
Data$Tipo <- NA
# Condicional Para Clasificar el Tipo de Servicio
Data$Tipo <- ifelse(Data$`Prestador/Vendedor` == "Nydia Gamba", "Alianza",
ifelse(Data$`Servicio/Producto` %in% Base_Tocador[[1]], "Tocador",
ifelse(Data$`Servicio/Producto` %in% Base_Spa[[1]], "Spa",
ifelse(Data$`Servicio/Producto` %in% Base_Depilacion[[1]], "Depilacion",
ifelse(Data$`Servicio/Producto` %in% Base_Bac[[1]], "Bac",
ifelse(Data$`Servicio/Producto` %in% Base_Colorimetria[[1]], "Colorimetria",
ifelse(Data$`Servicio/Producto` %in% Base_Venta[[1]], "Venta",
ifelse(Data$`Servicio/Producto` %in% Base_Maquillaje[[1]], "Maquillaje",
ifelse(Data$`Servicio/Producto` == "Propina desde", "Propina",
ifelse(Data$`Servicio/Producto` %in% Base_Maquillaje_Salon[[1]], "Maquillaje_S",
ifelse(Data$`Servicio/Producto` %in% Base_Accesorios[[1]], "Accesorios",
NA)))))))))))
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
source("0. Nomina/APP/4. Generar la Base de Descuentos.R")
source("0. Nomina/APP/5. Clasificacion Tipo de Servicio.R")
View(Data)
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
source("0. Nomina/APP/4. Generar la Base de Descuentos.R")
source("0. Nomina/APP/5. Clasificacion Tipo de Servicio.R")
#===============================================================================
View(Data)
nuevo_nombre
# Limpiar datos
Data_Color <- Data %>% select("Identificador","Fecha de Pago","Prestador/Vendedor","Nombre cliente","Servicio/Producto",
,"Precio de Lista","Precio", "Tipo")
# Filtrar las filas donde Part_profesional es "Descuento"
Data_Color <- Data_Color %>% filter(Tipo == "Colorimetria")
# Inicalización de la Variable Valor Producto
Data_Color$Valor_producto <- NA
# Obtener el nombre del archivo original sin la ruta ni la extensión
nombre_original <- tools::file_path_sans_ext(basename(nuevo_nombre))
# Crear el nombre del archivo de salida añadiendo " - Color" al nombre original
nombre_archivo_salida <- paste0(nombre_original, " - Color.xlsx")
nombre_archivo_salida
# Ruta de la Base de Datos de Descuentos
archivo_descuento <- "2. Descuentos/Otros/0. Formato.xlsx"
ruta_descuento <- "2. Descuentos/Otros"
# Ruta completa del archivo destino
archivo_destino <- file.path(ruta_descuento, nuevo_descuento)
# Copiar el archivo a la nueva ubicación con el nuevo nombre
file.copy(from = archivo_descuento, to = archivo_destino, overwrite = TRUE)
# Escribir el archivo con el nuevo nombre en la carpeta destino
write_xlsx(Data_Color, file.path("2. Descuentos/Color", nombre_archivo_salida))
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
source("0. Nomina/APP/4. Generar la Base de Descuentos.R")
source("0. Nomina/APP/5. Clasificacion Tipo de Servicio.R")
source("0. Nomina/APP/6. Generar la Base de Color.R")
#===============================================================================
# Importacion de los datos
install_formats() # Cuestiones de importacion de archivos del paquete rio
Data_Color <- import("2. Descuentos/Color", nombre_archivo_salida)
Data_Color <- read_excel("2. Descuentos/Color", nombre_archivo_salida)
nombre_archivo_salida
nombre_archivo_salida
# Limpiar datos
Data_Color <- Data %>% select("Identificador","Fecha de Pago","Prestador/Vendedor","Nombre cliente","Servicio/Producto",
,"Precio de Lista","Precio", "Tipo")
# Filtrar las filas donde Part_profesional es "Descuento"
Data_Color <- Data_Color %>% filter(Tipo == "Colorimetria")
# Inicalización de la Variable Valor Producto
Data_Color$Valor_producto <- NA
# Obtener el nombre del archivo original sin la ruta ni la extensión
nombre_original <- tools::file_path_sans_ext(basename(nuevo_nombre))
# Crear el nombre del archivo de salida añadiendo " - Color" al nombre original
nombre_archivo_salida <- paste0(nombre_original, " - Color.xlsx")
nombre_archivo_salida
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
source("0. Nomina/APP/4. Generar la Base de Descuentos.R")
source("0. Nomina/APP/5. Clasificacion Tipo de Servicio.R")
source("0. Nomina/APP/6. Generar la Base de Color.R")
#===============================================================================
# Manejo del directorio
getwd()
directorio <- "C:/Users/windows/Documents/GitHub/Problem_Set_1/ForeverChic/1. Ventas Mensuales"
setwd(directorio)
# Chequeo de los archivos del directorio
dir()
list.files()
# Importacion de los datos
install_formats() # Cuestiones de importacion de archivos del paquete rio
Data_Color <- import("2. Descuentos/Color", nombre_archivo_salida)
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
source("0. Nomina/APP/4. Generar la Base de Descuentos.R")
source("0. Nomina/APP/5. Clasificacion Tipo de Servicio.R")
source("0. Nomina/APP/6. Generar la Base de Color.R")
nombre_archivo_salida
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
source("0. Nomina/APP/4. Generar la Base de Descuentos.R")
source("0. Nomina/APP/5. Clasificacion Tipo de Servicio.R")
source("0. Nomina/APP/6. Generar la Base de Color.R")
nombre_archivo_salida
Data_Color <- read_excel("2. Descuentos/Color", nombre_archivo_salida)
ruta_archivo_salida <- file.path("2. Descuentos/Color", nombre_archivo_salida)
Data_Color <- read_excel(ruta_archivo_salida)
View(Data)
cadena_color <- paste0(numero_extraido". Color ", MES1, " ",  MIN, " al ", MES2, " ", MAX, ".xlsx")
cadena_color <- paste0(numero_extraido, ". Color - ", MES1, " ",  MIN, " al ", MES2, " ", MAX, ".xlsx")
cadena_color
rm(list = ls())
#===============================================================================
# Limpiar el entorno
rm(list = ls())
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
source("0. Nomina/APP/4. Generar la Base de Descuentos.R")
source("0. Nomina/APP/5. Clasificacion Tipo de Servicio.R")
source("0. Nomina/APP/6. Generar la Base de Color.R")
# Importacion de los datos
Data_Color <- read_excel(file.path("2. Descuentos/Color", nombre_archivo_salida))
View(Data_Color)
View(Data)
#===============================================================================
# Limpiar el entorno
rm(list = ls())
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
source("0. Nomina/APP/4. Generar la Base de Descuentos.R")
source("0. Nomina/APP/5. Clasificacion Tipo de Servicio.R")
source("0. Nomina/APP/6. Generar la Base de Color.R")
# Importacion de los datos
Data_Color <- read_excel(file.path("2. Descuentos/Color", nombre_archivo_salida))
View(Data_Color)
# Importacion de los datos
Data_Color <- read_excel(file.path("2. Descuentos/Color", nombre_archivo_salida))
View(Data_Color)
#===============================================================================
# Limpiar el entorno
rm(list = ls())
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
source("0. Nomina/APP/4. Generar la Base de Descuentos.R")
#===============================================================================
# Limpiar el entorno
rm(list = ls())
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
source("0. Nomina/APP/4. Generar la Base de Descuentos.R")
# Cargar la data
Data <- read_excel(file.path("1. Ventas Mensuales", nuevo_nombre))
# Lista de servicios por Tipo
Base_Tocador <- read_excel("0. Nomina/Info.xlsx", sheet = "1. Tocador")
Base_Spa <- read_excel("0. Nomina/Info.xlsx", sheet = "2. Spa")
Base_Depilacion <- read_excel("0. Nomina/Info.xlsx", sheet = "3. Depilacion")
Base_Bac <- read_excel("0. Nomina/Info.xlsx", sheet = "4. Bac")
Base_Colorimetria <- read_excel("0. Nomina/Info.xlsx", sheet = "5. Colorimetria")
Base_Venta <- read_excel("0. Nomina/Info.xlsx", sheet = "6. Venta")
Base_Maquillaje <- read_excel("0. Nomina/Info.xlsx", sheet = "7. Maquillaje")
Base_Maquillaje_Salon <- read_excel("0. Nomina/Info.xlsx", sheet = "8. Maquillaje Salon")
Base_Accesorios <- read_excel("0. Nomina/Info.xlsx", sheet = "9. Accesorios")
Base_Queratina <- read_excel("0. Nomina/Info.xlsx", sheet = "10. Queratina")
# Lista de Profesionales
Base_Profesionales <- read_excel("0. Nomina/Info.xlsx", sheet = "0. Profesionales")
# Inicalización de la Variable Tipo
Data$Tipo <- NA
# Condicional Para Clasificar el Tipo de Servicio
Data$Tipo <- ifelse(Data$`Prestador/Vendedor` == "Nydia Gamba", "Alianza",
ifelse(Data$`Servicio/Producto` %in% Base_Tocador[[1]], "Tocador",
ifelse(Data$`Servicio/Producto` %in% Base_Spa[[1]], "Spa",
ifelse(Data$`Servicio/Producto` %in% Base_Depilacion[[1]], "Depilacion",
ifelse(Data$`Servicio/Producto` %in% Base_Bac[[1]], "Bac",
ifelse(Data$`Servicio/Producto` %in% Base_Colorimetria[[1]], "Colorimetria",
ifelse(Data$`Servicio/Producto` %in% Base_Venta[[1]], "Venta",
ifelse(Data$`Servicio/Producto` %in% Base_Maquillaje[[1]], "Maquillaje",
ifelse(Data$`Servicio/Producto` == "Propina desde", "Propina",
ifelse(Data$`Servicio/Producto` %in% Base_Maquillaje_Salon[[1]], "Maquillaje_S",
ifelse(Data$`Servicio/Producto` %in% Base_Accesorios[[1]], "Accesorios",
ifelse(Data$`Servicio/Producto` %in% Base_Queratina[[1]], "Queratina", NA))))))))))))
View(Data)
#===============================================================================
# Limpiar el entorno
rm(list = ls())
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
source("0. Nomina/APP/4. Generar la Base de Descuentos.R")
# Cargar la data
Data <- read_excel(file.path("1. Ventas Mensuales", nuevo_nombre))
# Cargar la data
library(readxl)
Data <- read_excel(file.path("1. Ventas Mensuales", nuevo_nombre))
# Crear una lista de vectores desde el archivo Excel
sheets <- c("1. Tocador", "2. Spa", "3. Depilacion", "4. Bac",
"5. Colorimetria", "6. Venta", "7. Maquillaje",
"8. Maquillaje Salon", "9. Accesorios", "10. Queratina")
tipos <- c("Tocador", "Spa", "Depilacion", "Bac",
"Colorimetria", "Venta", "Maquillaje",
"Maquillaje_S", "Accesorios", "Queratina")
# Leer todas las hojas y guardar en una lista de vectores
servicios <- lapply(seq_along(sheets), function(i) {
list(tipo = tipos[i], items = read_excel("0. Nomina/Info.xlsx", sheet = sheets[i])[[1]])
})
# Inicialización de la variable Tipo
Data$Tipo <- "NA"
# Clasificación de los servicios
Data$Tipo <- ifelse(Data$`Prestador/Vendedor` == "Nydia Gamba", "Alianza",
sapply(Data$`Servicio/Producto`, function(producto) {
match <- sapply(servicios, function(servicio) producto %in% servicio$items)
if (any(match)) servicios[[which(match)]]$tipo else if (producto == "Propina desde") "Propina" else NA
}))
#===============================================================================
# Limpiar el entorno
#rm(list = ls())
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
#===============================================================================
# Limpiar el entorno
rm(list = ls())
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
source("0. Nomina/APP/4. Generar la Base de Descuentos.R")
source("0. Nomina/APP/5. Clasificacion Tipo de Servicio.R")
# Limpiar datos
Data_Color <- Data %>% select("Identificador","Fecha de Pago","Prestador/Vendedor"
,"Nombre cliente","Servicio/Producto"
,"Precio", "Tipo")
# Filtrar las filas donde Part_profesional es "Descuento"
Data_Color <- Data_Color %>% filter(Tipo %in% c("Colorimetria", "Queratina"))
# Inicalización de la Variable Valor Producto
Data_Color$Valor_producto <- NA
View(servicios)
#===============================================================================
# Limpiar el entorno
rm(list = ls())
#===============================================================================
source("0. Nomina/APP/1. Cargar la Base.R")
source("0. Nomina/APP/2. Nombre del Archivo Base.R")
source("0. Nomina/APP/3. Agregar y Eliminar la Base.R")
source("0. Nomina/APP/4. Generar la Base de Descuentos.R")
source("0. Nomina/APP/5. Clasificacion Tipo de Servicio.R")
rm(list = ls(servicios))
rm(list = servicios)
#===============================================================================
rm(servicios)
#===============================================================================
# Limpiar datos
Data_Color <- Data %>% select("Identificador","Fecha de Pago","Prestador/Vendedor"
,"Nombre cliente","Servicio/Producto"
,"Precio", "Tipo")
# Filtrar las filas donde Part_profesional es "Descuento"
Data_Color <- Data_Color %>% filter(Tipo %in% c("Colorimetria", "Queratina"))
View(Data_Color)
View(Data)
# Inicalización de la Variable Valor Producto
Data_Color$Valor_producto <- NA
Data_Color$Ayuda <- NA
# Crear el nombre del archivo de salida añadiendo " - Color" al nombre original
nombre_archivo_salida <- paste0(numero_extraido, ". Color - ", MES1, " ",  MIN, " al ", MES2, " ", MAX, ".xlsx")
# Escribir el archivo con el nuevo nombre en la carpeta destino
write_xlsx(Data_Color, file.path("2. Descuentos/Color", nombre_archivo_salida))
nombre_archivo_salida
sumade <- sum(Data$Precio)
sumade
View(Base_Profesionales)
